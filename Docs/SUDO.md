# SUDO — בדיקה, פירוש והמלצות

**מטרה:** דף זה מסביר כיצד לבדוק במהירות את המצב שלך ביחס להרשאות `sudo`, כיצד לפרש את הפלט של `sudo -l`, ומה ההמלצות לבטיחות ותיקון. התוכן מיועד לשימוש לימודי/אדיטיבי בלבד.

---

## בדיקה מהירה — `sudo -l`

כדי לבדוק אילו פקודות אתה רשאי להריץ ב־sudo:

```bash
sudo -l
```

**מה זה מחזיר (בקצרה):**

* רשימת פקודות שמותר לך להריץ דרך `sudo` (לעתים כ־root, לעתים כמשתמש אחר).
* שורה המציינת אם יש `NOPASSWD` (אין צורך בסיסמה) — זה אומר שהמשתמש יכול להריץ את הפקודה ללא אימות נוסף.

> חשוב: הפקודה `sudo -l` לא מבצעת שינוי במערכת — היא רק מדווחת על ההרשאות.

---

## דוגמת פלט ופרשנות (המחשה)

```
User user1 may run the following commands on this host:
    (root) NOPASSWD: /usr/bin/vim
    (root) /usr/bin/systemctl restart apache2
    (dbadmin) /usr/bin/pg_dump
```

**פרשנות:**

* `(/root) NOPASSWD: /usr/bin/vim` — המשתמש יכול להריץ את `vim` כ־root ללא סיסמה. תלוי איך `vim` נבנה/מוגדר, יכולות להיות השלכות (לצורך אבחון בלבד יש לכך סיכונים).
* `(/root) /usr/bin/systemctl restart apache2` — המשתמש יכול להריץ את הפקודה הזו כ־root אך יצטרך להזין את סיסמתו (אם לא צויין NOPASSWD).
* `(dbadmin) /usr/bin/pg_dump` — המשתמש יכול להריץ את `pg_dump` בתור המשתמש dbadmin (לא כ־root).

---

## מקורות למידע נוסף (לאפשר חקירה ממוקדת)

* אתר שימושי: **GTFOBins** — מאגר שמתעד כיצד תוכניות נפוצות יכולות לשמש עם הרשאות גבוהות. [https://gtfobins.github.io/](https://gtfobins.github.io/)

  * הערה: האתר הוא מקור ידע טכני — יש להשתמש בו רק למטרות אתיות, במעבדה או באודיט מורשה.

---

## המלצות להגנה ותיקון

1. **הגבילו שימוש ב־NOPASSWD** — אל תתנו הרשאות ללא אימות אלא אם יש לכך סיבה טכנית ממשית ומבוקרת.
2. **הרשאות על פקודות ספציפיות בלבד** — הימנעו מלתת `ALL` או `ALL=(ALL) ALL` למשתמשים שלא צריכים זאת. סווגו לפי פעולה מדויקת ונתיב מוחלט.
3. **השתמשו בנתיבים מוחלטים** — בקביעת פקודות ב־sudoers השתמשו בנתיב מלא (`/usr/bin/command`) כדי למנוע בעיות PATH hijack.
4. **ניקוי סביבת ENV בפריבילגיות** — נקו/הגדרו משתני סביבה נדרשים לביצו
